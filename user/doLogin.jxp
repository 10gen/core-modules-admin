<%
    core.user.auth();
    user = Auth.getUser( request );

if ( ! user ){
    print( "invalid username/password" );
    Auth.cookie.reject( request , response );
    return;
}

if(User.requirements.confirmed_email && user && ! user.hasPermission("confirmed_email")){
    core.user.confirm_send();
}

to = request.to || "/";
if(notice)
    to = to + "?notice="+notice;

response.setResponseCode( 301 );
response.setHeader( "Location" , to );

%>


